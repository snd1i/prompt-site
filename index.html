<script>
let credit = localStorage.getItem("credit");
if (credit === null) {
  credit = 5;
  localStorage.setItem("credit", credit);
}
credit = parseInt(credit);
document.getElementById("credit").innerText = credit;

const SHEET_ID = "1a4gxpaMg2gHNP9krJtVtqmDwMsvpY1KD1tqIes6zNNY";
const SHEET_NAME = "Sheet1";
const URL = `https://opensheet.elk.sh/${SHEET_ID}/${SHEET_NAME}`;

fetch(URL)
  .then(res => res.json())
  .then(data => {
    const container = document.createElement("div");

    data.forEach((item, i) => {
      const card = document.createElement("div");
      card.className = "card";

      card.innerHTML = `
        <img src="${item.image}">
        <button onclick="unlock(${i})">Unlock Prompt (1 Credit)</button>
        <p id="p${i}" style="display:none;margin-top:10px;">${item.prompt}</p>
      `;

      container.appendChild(card);
    });

    document.body.appendChild(container);
  })
  .catch(err => {
    alert("Sheet error");
    console.log(err);
  });

function unlock(i) {
  if (credit <= 0) {
    alert("No credits");
    return;
  }
  credit--;
  localStorage.setItem("credit", credit);
  document.getElementById("credit").innerText = credit;
  document.getElementById("p" + i).style.display = "block";
}
</script>

